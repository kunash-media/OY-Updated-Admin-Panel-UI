<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    

     <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ancizar+Serif&display=swap" rel="stylesheet">
    

    <style>
     .size-selection {
    background: #f7fafc;
    border-radius: 15px;
    padding: 25px;
    border: 2px solid #e2e8f0;
    transition: all 0.3s ease;
}

.size-selection:hover {
    border-color: #667eea;
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(102, 126, 234, 0.1);
}

.size-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
}

.size-option {
    position: relative;
}

.size-checkbox {
    display: none;
}

.size-label {
    display: block;
    padding: 15px 10px;
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    text-align: center;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.size-label:hover {
    border-color: #667eea;
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(102, 126, 234, 0.2);
}

.size-checkbox:checked + .size-label {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border-color: #667eea;
    transform: scale(1.05);
}

.custom-size-input {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-top: 15px;
}

.custom-size-input input {
    flex: 1;
    padding: 12px 16px;
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    font-size: 1rem;
    transition: all 0.3s ease;
}

.custom-size-input input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.selected-sizes {
    margin-top: 25px;
}

.size-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}
            
.action-buttons {
  white-space: nowrap; 
}


.action-buttons .btn {
  margin-right: 4px; 
}

.action-buttons .btn:last-child {
  margin-right: 0; 
}
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            font-family: Arial, sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        .navbar {
            background-color:  	#2d2d30;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            font-family: "roboto";
        }
        
        .navbar .dashboard {
            color: white;
            font-size: 18px;
            display: flex;
            align-items: center;
        }
        
        .navbar .menu-icon {
            color: white;
            margin-left: 15px;
            cursor: pointer;
        }
        
        .navbar .icons {
            display: flex;
            align-items: center;
        }
        
        .icons>i {
            margin-right: 20px;
        }
        
        .profile-dropdown {
            position: relative;
            display: inline-block;
        }
        
        .profile-menu {
            display: none;
            position: absolute;
            right: 0;
            background: white;
            box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            width: 150px;
            z-index: 1000;
        }
        
        .profile-menu a {
            display: block;
            padding: 10px;
            text-decoration: none;
            color: black;
        }
        
        .profile-menu a:hover {
            background: #f1f1f1;
        }
        
        .profile-icon {
            cursor: pointer;
            color: white;
            font-size: 1.2em;
        }
        
        .left-nav {
            width: 220px;
            background-color:  	#2d2d30;
            position: fixed;
            top: 50px;
            left: 0;
            height: calc(100vh - 50px);
            display: none;
            padding: 10px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            z-index: 999;
            font-family: "Open Sans";
        }
        
        .left-nav .category {
            cursor: pointer;
            margin: 15px 0;
            color: rgb(255, 255, 255);
        }


        .left-nav .sub-category a div,
        .left-nav .category {
        color: rgb(255, 255, 255) !important;
        text-decoration: none !important;
        }

        .left-nav .sub-category a:hover div {
            color: rgb(252, 251, 251) !important;
            text-decoration: none !important;
        }

        .left-nav .sub-category a {
            text-decoration: none !important;
        }
        
        .sub-category {
            margin-left: 20px;
            display: none;
        }
        
        .logout-button {
            background-color: #005f73;
            color: #d3d3d3;
            border: none;
            padding: 10px;
            width: 100%;
            cursor: pointer;
            margin-top: 20px;
        }
        
        .logout-button:hover {
            background-color: #007bff;
        }
        
        .main-content {
            font-family: "Ancizar Serif ";
            margin-left: 18%;
            padding: 70px 0px 0px 0px;
            transition: margin-left 0.3s;
        }
        
     
        
        footer {
            background-color: #808080;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 30px;
            width: 100%;
            /* font-family: "Open Sans"; */
             font-family: "Ancizar Serif ";
        }
        

        .left-nav a {
        color: inherit !important;
        text-decoration: none !important;
        }

        .left-nav a:hover {
        color: inherit !important;
        text-decoration: none !important;
        }

        .profile-icon {
        cursor: pointer;
        color: white;
        font-size: 1.7em; 
        }
        

    </style>
</head>

<body>
    <nav class="navbar">
        <div class="dashboard">
            <i class="fas fa-bars menu-icon" id="menuIcon"></i>
            <span style="margin-left: 10px; font-size: 20px;">Dashboard</span>
        </div>

        <div class="icons">
            <div class="profile-dropdown">
                <i class="fas fa-user-circle profile-icon" id="profileIcon"></i>
                <div class="profile-menu" id="profileMenu" style=" font-family: Open Sans;">
                    <!-- <a href="">Profile</a> -->
                    <a href="Login.html">Logout</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="left-nav" id="leftNav">
        <div class="category" id="catalog">Inventory<i class="fas fa-chevron-down" id="catalogToggle"></i></div>
        <div class="sub-category" id="catalogSub">
           <a href="Products.html"><div>Products</div></a> 
            <!-- <a href="Category.html"><div>Categories</div></a> -->
            <a href="Coupon.html"><div>Coupons</div></a>
        </div>
        <div class="category" id="customers">Customers <i class="fas fa-chevron-down" id="customersToggle"></i></div>
        <div class="sub-category" id="customersSub">
           <a href="CustomerDetails.html"><div>Customer Details</div></a> 
        </div>
       <a href=""><div class="category" >Orders</div></a> 
        <div class="category" id="onlineStore">Online Store <i class="fas fa-chevron-down" id="onlineStoreToggle"></i></div>
        <div class="sub-category" id="onlineStoreSub" style="display: none;">
            <a href="https://jewelry-frontend-six.vercel.app/"><div>View Store</div></a>            <a href="StoreCustomization.html"><div>Store Customization</div></a>
            <!-- <a href="StoreSettings.html"><div>Store Settings</div></a> -->
        </div>
        <a href="OurStaff.html"><div class="category">Our Staff</div></a>
       <a href="Settings.html"><div class="category" id="settings">Settings</div></a> 
        <button class="logout-button" onclick="window.location.href='Login.html'"> <i class="fas fa-sign-out-alt"></i> Logout</button>
    </div>

    <div class="main-content">
        <h3 class="mb-4" style="font-size:21px; font-weight: 350; font-family:roboto; "><b>Products</b></h3>

    </div>

<div class="button-container d-flex justify-content-between align-items-center" style="margin-left: 270px; margin-top: 20px; margin-bottom: 30px; padding: 25px; background-color: #f8f9fa; border-radius: 5px; margin-right: 40px;border:1px solid grey">
        <div class="left-buttons">
            <div class="btn-group me-2">
                <button class="btn btn-outline-primary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fas fa-file-export"></i> Export
                </button>
                <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="#"><i class="fas fa-file-excel"></i> Export by Excel</a></li>
                    <li><a class="dropdown-item" href="#"><i class="fas fa-file-csv"></i> Export by CSV</a></li>
                </ul>
            </div>
            <div class="btn-group">
                <button class="btn btn-outline-success" type="button" data-bs-toggle="collapse" data-bs-target="#importCollapse">
                    <i class="fas fa-file-import"></i> Import
                </button>
                <div id="importCollapse" class="collapse" style="position: absolute; z-index: 1000; width: 300px; margin-top: 5px;">
                    <div class="card card-body" style="border: 2px dashed #6c757d; padding: 20px;">
                        <input type="file" id="fileInput" style="display: none;" multiple>
                        <p class="text-center" onclick="document.getElementById('fileInput').click()" style="cursor: pointer;">Click to select files</p>
                            <button class="btn btn-primary ms-auto" style="width: fit-content;" onclick="handleImport()">
                            <i class="fas fa-upload"></i> Import Now
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="right-buttons">
            <button class="btn btn-outline-danger me-2" id="deleteSelectedBtn">
                <i class="fas fa-trash"></i> Delete
            </button>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addProductModal">
                <i class="fas fa-plus"></i> Add Product
            </button>
        </div>
    </div>

    <div class="filter-container d-flex align-items-center" style="margin-left: 270px; margin-top: 20px; margin-bottom: 30px; padding: 25px; background-color: #f8f9fa; border-radius: 5px; margin-right: 40px; border:1px solid grey">
        <div class="search-box me-3" style="flex: 1;">
            <div class="input-group">
                <input type="text" class="form-control" id="searchInput" placeholder="Search by Order ID or Product Name...">
                <button class="btn btn-outline-secondary" type="button" id="searchBtn">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>

        <div class="dropdown me-3">
            <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="categoryDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                Category
            </button>
            <ul class="dropdown-menu" aria-labelledby="categoryDropdown">
                <li><a class="dropdown-item active" href="#" data-value="all">All Categories</a></li>
                <li><a class="dropdown-item" href="#" data-value="Necklaces">Necklaces</a></li>
                <li><a class="dropdown-item" href="#" data-value="Rings">Rings</a></li>
                <li><a class="dropdown-item" href="#" data-value="Bracelets">Bracelets</a></li>
                <li><a class="dropdown-item" href="#" data-value="Earrings">Earrings</a></li>
            </ul>
        </div>

        <div class="dropdown me-3">
            <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="priceDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                Price
            </button>
            <ul class="dropdown-menu" aria-labelledby="priceDropdown">
                <li><a class="dropdown-item active" href="#" data-value="all">All Prices</a></li>
                <li><a class="dropdown-item" href="#" data-value="under10000">Under ₹10000</a></li>
                <li><a class="dropdown-item" href="#" data-value="10000-100000">₹10000 - ₹100000</a></li>
                <li><a class="dropdown-item" href="#" data-value="over100000">Over ₹100000</a></li>
            </ul>
        </div>

        <button class="btn btn-primary me-2" id="filterBtn">
            <i class="fas fa-filter"></i> Filter
        </button>

        <button class="btn btn-outline-danger" id="resetBtn">
            <i class="fas fa-undo"></i> Reset
        </button>
    </div>

<div class="product-table-container" style="margin-left: 270px; margin-right: 40px; overflow-x: hidden; max-width: calc(100vw - 310px);">         
    <table class="table table-bordered table-hover" style="width: 100%; table-layout: fixed;">             
        <thead class="table-light">                 
            <tr>                     
                <th width="50px"><input type="checkbox" onclick="toggleSelectAll(this)"></th>                     
                <th>Product ID</th>                     
                <th>Product Name</th>                     
                <th>Category</th>                     
                <th>Stock</th>                     
                <th>Product Image</th>                     
                <th>Shop By</th>                     
                <th>Price</th>                     
                <th>Discount</th>                     
                <th>GST</th>                     
                <th>Coupon Code</th>                     
                <th>Total Price</th>                     
                <th>Quantity</th> 
                <th>Size</th>                    
                <th>Offers</th>                     
                <th>Action</th>                 
            </tr>             
        </thead>             
        <tbody id="productsTableBody">                 
            <!-- Products will be inserted here dynamically -->             
        </tbody>         
    </table>     
</div>
    <div class="left-nav" id="leftNav">
        <div class="category" id="catalog">Catalog <i class="fas fa-chevron-down" id="catalogToggle"></i></div>
        <div class="sub-category" id="catalogSub">
            <div>Products</div>
            <div>Categories</div>
            <div>Coupons</div>
        </div>
        <div class="category" id="customers">Customers <i class="fas fa-chevron-down" id="customersToggle"></i></div>
        <div class="sub-category" id="customersSub">
            <div>Customer Details</div>
        </div>
        <div class="category">Orders</div>
        <div class="category" id="onlineStore">Online Store <i class="fas fa-chevron-down" id="onlineStoreToggle"></i></div>
        <div class="sub-category" id="onlineStoreSub" style="display: none;">
            <div>View Store</div>
            <div>Store Customization</div>
            <div>Store Settings</div>
        </div>
        <div class="category">Our Staff</div>
        <div class="category" id="settings">Settings</div>
        <button class="logout-button"> <i class="fas fa-sign-out-alt"></i> Logout</button>
    </div>


    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="deleteConfirmationModal" tabindex="-1" aria-labelledby="deleteConfirmationModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="deleteConfirmationModalLabel">Confirm Deletion</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="deleteMessage">Are you sure you want to delete the selected items?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Product Modal -->
    <div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addProductModalLabel">Add New Product</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="productForm">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="orderId" class="form-label">Product ID</label>
                                <input type="text" class="form-control" id="orderId" required>
                            </div>
                            <div class="col-md-6">
                                <label for="productName" class="form-label">Product Name</label>
                                <input type="text" class="form-control" id="productName" required>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="shopBy" class="form-label">Shop By</label>
                                <select class="form-select" id="shopBy" multiple>
                                    <option>Party Wear</option>
                                    <option>Wedding Wear</option>
                                    <option>Office Wear</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Category</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="rings">
                                    <label class="form-check-label" for="rings">Rings</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="necklaces">
                                    <label class="form-check-label" for="necklaces">Necklaces</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="earrings">
                                    <label class="form-check-label" for="earrings">Earrings</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="bracelets">
                                    <label class="form-check-label" for="bracelets">Bracelets</label>
                                </div>
                            </div>
                        </div>

                        <!-- In the "Add Product" modal (inside the form), add this section after the offers section -->
<div class="row mb-3">
    <div class="col-md-12">
        <label class="form-label">Available Sizes</label>
        <div class="size-selection">
            <div class="size-grid" id="sizeGrid">
                <!-- Size options will be populated by JavaScript -->
            </div>

            <div class="custom-size-input">
                <input type="text" class="form-control" id="customSize" placeholder="Add custom size (e.g., XXL, 2XL)" maxlength="5">
                <button type="button" class="btn btn-outline-secondary" onclick="addCustomSize()">
                    <span>+</span>
                    Add Size
                </button>
            </div>

            <div class="selected-sizes" id="selectedSizes" style="display: none;">
                <h4>Selected Sizes:</h4>
                <div class="size-tags" id="sizeTags"></div>
            </div>
        </div>
    </div>
</div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="stock" class="form-label">Stock</label>
                                <select class="form-select" id="stock" required>
                                    <option>In Stock</option>
                                    <option>Out of Stock</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="productImage" class="form-label">Product Image</label>
                                <input type="file" class="form-control" id="productImage" accept="image/*">
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="price" class="form-label">Price (₹)</label>
                                <input type="number" class="form-control" id="price" step="0.01" required>
                            </div>
                            <div class="col-md-4">
                                <label for="discount" class="form-label">Discount (%)</label>
                                <input type="number" class="form-control" id="discount" step="0.01">
                            </div>
                            <div class="col-md-4">
                                <label for="gst" class="form-label">GST (%)</label>
                                <input type="number" class="form-control" id="gst" step="0.01" required>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="couponCode" class="form-label">Coupon Code</label>
                                <input type="text" class="form-control" id="couponCode">
                            </div>
                            <div class="col-md-4">
                                <label for="totalPrice" class="form-label">Total Price (₹)</label>
                                <input type="text" class="form-control" id="totalPrice" readonly>
                            </div>
                            <div class="col-md-4">
                                <label for="quantity" class="form-label">Quantity</label>
                                <input type="number" class="form-control" id="quantity" min="1" value="1" required>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label class="form-label">Offers</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="offerType" id="option1" value="option1" checked>
                                    <label class="form-check-label" for="option1">Option 1</label>
                                </div>
                                <div id="option1Options" style="margin-left: 20px; margin-top: 10px;">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="offer1" value="Free Shipping">
                                        <label class="form-check-label" for="offer1">Free Shipping</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="offer2" value="Buy 1 Get 1">
                                        <label class="form-check-label" for="offer2">Buy 1 Get 1</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="offer3" value="10% Cashback">
                                        <label class="form-check-label" for="offer3">10% Cashback</label>
                                    </div>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="offerType" id="option2" value="option2">
                                    <label class="form-check-label" for="option2">Option 2</label>
                                </div>
                                <div id="option2Input" style="margin-left: 20px; margin-top: 10px; display: none;">
                                    <input type="number" class="form-control" id="offerValue" min="0" value="0" style="width: 100px;">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="addProductBtn">Add Product</button>
                </div>
            </div>
        </div>
    </div>


    <footer style="background-color: #f0f0f0; height: 60px; display: flex; align-items: center; justify-content: center;font-family: Open Sans;">
        <!-- <img src="Img/logo.jpg" alt="Kunash Media Logo" style="height: 40px;  width:60px ;margin-right: 15px;"> -->
        <p style="color: black; font-weight: 400; margin: 0; font-size: medium;">© 2025 Kunash Media | Developed by Pranjal Prasad</p>
    </footer>


<script>


// Add these variables at the top of your script with other variables
const commonSizes = ['XS', 'S', 'M', 'L', 'XL', 'XXL'];
let selectedSizes = [];

// Add this function to initialize the size selection
function initializeSizeSelection() {
    const sizeGrid = document.getElementById('sizeGrid');
    if (!sizeGrid) return;
    
    sizeGrid.innerHTML = '';
    
    commonSizes.forEach(size => {
        const div = document.createElement('div');
        div.className = 'size-option';
        div.innerHTML = `
            <input type="checkbox" id="size-${size}" class="size-checkbox" onchange="toggleSize('${size}')">
            <label for="size-${size}" class="size-label">${size}</label>
        `;
        sizeGrid.appendChild(div);
    });
}

// Add these functions to handle size selection
function toggleSize(size) {
    const checkbox = document.getElementById(`size-${size}`);
    
    if (checkbox.checked) {
        if (!selectedSizes.includes(size)) {
            selectedSizes.push(size);
        }
    } else {
        selectedSizes = selectedSizes.filter(s => s !== size);
    }
    
    updateSelectedSizes();
}

function addCustomSize() {
    const input = document.getElementById('customSize');
    const customSize = input.value.trim().toUpperCase();
    
    if (customSize && !selectedSizes.includes(customSize) && !commonSizes.includes(customSize)) {
        selectedSizes.push(customSize);
        input.value = '';
        updateSelectedSizes();
        
        // Add to the grid if it exists
        const sizeGrid = document.getElementById('sizeGrid');
        if (sizeGrid) {
            const div = document.createElement('div');
            div.className = 'size-option';
            div.innerHTML = `
                <input type="checkbox" id="size-${customSize}" class="size-checkbox" onchange="toggleSize('${customSize}')" checked>
                <label for="size-${customSize}" class="size-label">${customSize}</label>
            `;
            sizeGrid.appendChild(div);
        }
    } else if (selectedSizes.includes(customSize) || commonSizes.includes(customSize)) {
        alert('Size already exists!');
    }
}

function removeSize(size) {
    selectedSizes = selectedSizes.filter(s => s !== size);
    const checkbox = document.getElementById(`size-${size}`);
    if (checkbox) {
        checkbox.checked = false;
    }
    updateSelectedSizes();
}

function updateSelectedSizes() {
    const selectedSizesDiv = document.getElementById('selectedSizes');
    const sizeTagsDiv = document.getElementById('sizeTags');
    
    if (!selectedSizesDiv || !sizeTagsDiv) return;
    
    if (selectedSizes.length > 0) {
        selectedSizesDiv.style.display = 'block';
        sizeTagsDiv.innerHTML = selectedSizes.map(size => `
            <span class="badge bg-primary me-1">
                ${size}
                <button type="button" class="btn-close btn-close-white btn-sm ms-1" onclick="removeSize('${size}')"></button>
            </span>
        `).join('');
    } else {
        selectedSizesDiv.style.display = 'none';
    }
}

// Call this in your DOMContentLoaded event listener
document.addEventListener('DOMContentLoaded', function() {
    // ... existing code ...
    initializeSizeSelection();
    
    // Also handle Enter key in custom size input
    const customSizeInput = document.getElementById('customSize');
    if (customSizeInput) {
        customSizeInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                addCustomSize();
            }
        });
    }
});

// Update the product data object in the addProductBtn click handler to include sizes
// In the saveProduct function, modify the productData object to include:
const productData = {
    // ... existing properties ...
    sizes: selectedSizes.join(', ') || 'One Size'
};
document.addEventListener('DOMContentLoaded', function() {
    // Initialize with sample data if localStorage is empty
    initializeSampleData();
    renderProducts();

    // Left nav toggle
    document.getElementById('menuIcon')?.addEventListener('click', function() {
        const leftNav = document.getElementById('leftNav');
        leftNav.style.display = leftNav.style.display === 'block' ? 'none' : 'block';
    });

    // Profile menu toggle
    document.getElementById('profileIcon')?.addEventListener('click', function(e) {
        e.stopPropagation();
        const menu = document.getElementById('profileMenu');
        menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
    });

    // Close profile menu when clicking outside
    document.addEventListener('click', function() {
        const profileMenu = document.getElementById('profileMenu');
        if (profileMenu) profileMenu.style.display = 'none';
    });

    // Submenu toggles
    document.getElementById('onlineStoreToggle')?.addEventListener('click', function() {
        const sub = document.getElementById('onlineStoreSub');
        sub.style.display = sub.style.display === 'block' ? 'none' : 'block';
    });
    
    document.getElementById('catalogToggle')?.addEventListener('click', function() {
        const sub = document.getElementById('catalogSub');
        sub.style.display = sub.style.display === 'block' ? 'none' : 'block';
    });

    document.getElementById('customersToggle')?.addEventListener('click', function() {
        const sub = document.getElementById('customersSub');
        sub.style.display = sub.style.display === 'block' ? 'none' : 'block';
    });

    // Initialize with sample data if localStorage is empty
    function initializeSampleData() {
        const sampleProducts = [
            {
                productId: "PR001",
                productName: "Diamond Necklace",
                categories: "Necklaces",
                stock: "In Stock",
                imageSrc: "https://via.placeholder.com/50",
                shopByOptions: "Wedding Wear, Party Wear",
                price: "25000.00",
                discount: "10",
                gst: "18",
                couponCode: "DIAMOND10",
                totalPrice: "24300.00",
                quantity: "1",
                offers: "Free Shipping, 10% Cashback"
            },
            {
                productId: "PR002",
                productName: "Gold Ring",
                categories: "Rings",
                stock: "In Stock",
                imageSrc: "https://via.placeholder.com/50",
                shopByOptions: "Wedding Wear",
                price: "15000.00",
                discount: "5",
                gst: "18",
                couponCode: "GOLD5",
                totalPrice: "16237.50",
                quantity: "2",
                offers: "Buy 1 Get 1"
            }
        ];

        const products = JSON.parse(localStorage.getItem('products') || '[]');
        if (products.length === 0) {
            localStorage.setItem('products', JSON.stringify(sampleProducts));
        }
    }

    // Calculate total price when inputs change
    document.getElementById('price')?.addEventListener('input', calculateTotal);
    document.getElementById('discount')?.addEventListener('input', calculateTotal);
    document.getElementById('gst')?.addEventListener('input', calculateTotal);
    document.getElementById('quantity')?.addEventListener('input', calculateTotal);

    function calculateTotal() {
        const price = parseFloat(document.getElementById('price').value) || 0;
        const discount = parseFloat(document.getElementById('discount').value) || 0;
        const gst = parseFloat(document.getElementById('gst').value) || 0;
        const quantity = parseInt(document.getElementById('quantity').value) || 1;

        const discountAmount = price * (discount / 100);
        const subtotal = (price - discountAmount) * quantity;
        const gstAmount = subtotal * (gst / 100);
        const total = subtotal + gstAmount;

        document.getElementById('totalPrice').value = total.toFixed(2);
    }

    // Save products to localStorage
    function saveProducts(products) {
        try {
            localStorage.setItem('products', JSON.stringify(products));
        } catch (error) {
            if (error.name === 'QuotaExceededError') {
                alert("Storage is full! Clearing old data...");
                localStorage.clear();
                localStorage.setItem('products', JSON.stringify(products));
            } else {
                alert("Error saving products: " + error.message);
            }
        }
    }

    // Load products from localStorage
    function loadProducts() {
        const products = JSON.parse(localStorage.getItem('products') || '[]');
        return products;
    }

    // Render products to table
    function renderProducts(products = null) {
        const tbody = document.getElementById('productsTableBody');
        if (!tbody) return;
        
        tbody.innerHTML = '';

        const productsToRender = products || loadProducts();
        
        productsToRender.forEach(product => {
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
    <td><input type="checkbox" class="row-checkbox"></td>
    <td>${product.productId}</td>
    <td>${product.productName}</td>
    <td>${product.categories}</td>
    <td>${product.stock}</td>
    <td><img src="${product.imageSrc}" alt="Product" style="width:50px;height:50px;"></td>
    <td>${product.shopByOptions}</td>
    <td>₹${product.price}</td>
    <td>${product.discount}%</td>
    <td>${product.gst}%</td>
    <td>${product.couponCode}</td>
    <td>₹${product.totalPrice}</td>
    <td>${product.quantity}</td>
    <td>${product.sizes || 'One Size'}</td>
    <td>${product.offers || ''}</td>
    <td class="action-buttons">
        <button class="btn btn-sm btn-outline-info inventory-btn" title="Inventory"><i class="fas fa-box"></i></button>
        <button class="btn btn-sm btn-outline-primary edit-btn" data-product-id="${product.productId}"><i class="fas fa-edit"></i></button>
        <button class="btn btn-sm btn-outline-danger delete-btn" data-product-id="${product.productId}"><i class="fas fa-trash"></i></button>
    </td>
`;
            tbody.appendChild(newRow);
        });

        // Add event listeners after rendering
        attachEventListeners();
    }

    // Attach event listeners to dynamically created elements
    function attachEventListeners() {
        // Delete button listeners
        document.querySelectorAll('.delete-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                const productId = this.getAttribute('data-product-id');
                
                if (confirm(`Are you sure you want to delete product ${productId}?`)) {
                    const products = loadProducts();
                    const updatedProducts = products.filter(p => p.productId !== productId);
                    saveProducts(updatedProducts);
                    renderProducts();
                }
            });
        });

        // Inventory button listeners
        document.querySelectorAll('.inventory-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                const row = this.closest('tr');
                const productId = row.cells[1].textContent;
                const productName = row.cells[2].textContent;
                const price = row.cells[7].textContent;
                const quantity = row.cells[12].textContent;
                const totalPrice = row.cells[11].textContent;
                
                // Show invoice modal or alert
                alert(`Invoice for ${productName}\nProduct ID: ${productId}\nUnit Price: ${price}\nQuantity: ${quantity}\nTotal: ${totalPrice}`);
            });
        });

        // Edit button listeners
        document.querySelectorAll('.edit-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                const productId = this.getAttribute('data-product-id');
                const products = loadProducts();
                const productToEdit = products.find(p => p.productId === productId);
                
                if (productToEdit) {
                    // Check if modal exists
                    const modal = document.getElementById('addProductModal');
                    if (!modal) {
                        alert('Edit modal not found. Please ensure the modal HTML is present.');
                        return;
                    }

                    // Populate the modal with product data
                    const orderIdField = document.getElementById('orderId');
                    const productNameField = document.getElementById('productName');
                    const stockField = document.getElementById('stock');
                    const priceField = document.getElementById('price');
                    const discountField = document.getElementById('discount');
                    const gstField = document.getElementById('gst');
                    const couponCodeField = document.getElementById('couponCode');
                    const totalPriceField = document.getElementById('totalPrice');
                    const quantityField = document.getElementById('quantity');

                    if (orderIdField) orderIdField.value = productToEdit.productId;
                    if (productNameField) productNameField.value = productToEdit.productName;
                    if (stockField) stockField.value = productToEdit.stock;
                    if (priceField) priceField.value = parseFloat(productToEdit.price);
                    if (discountField) discountField.value = parseFloat(productToEdit.discount);
                    if (gstField) gstField.value = parseFloat(productToEdit.gst);
                    if (couponCodeField) couponCodeField.value = productToEdit.couponCode;
                    if (totalPriceField) totalPriceField.value = parseFloat(productToEdit.totalPrice);
                    if (quantityField) quantityField.value = productToEdit.quantity;
                    
                    // Set shop by options if exists
                    const shopBySelect = document.getElementById('shopBy');
                    if (shopBySelect) {
                        const shopByOptions = productToEdit.shopByOptions.split(',').map(s => s.trim());
                        Array.from(shopBySelect.options).forEach(option => {
                            option.selected = shopByOptions.includes(option.value);
                        });
                    }
                    
                    // Set categories checkboxes if they exist
                    const categories = productToEdit.categories.split(',').map(s => s.trim());
                    document.getElementById('rings') && (document.getElementById('rings').checked = categories.includes('Rings'));
                    document.getElementById('necklaces') && (document.getElementById('necklaces').checked = categories.includes('Necklaces'));
                    document.getElementById('earrings') && (document.getElementById('earrings').checked = categories.includes('Earrings'));
                    document.getElementById('bracelets') && (document.getElementById('bracelets').checked = categories.includes('Bracelets'));
                    
                    // Set offers if they exist
                    if (productToEdit.offers) {
                        document.getElementById('offer1') && (document.getElementById('offer1').checked = productToEdit.offers.includes('Free Shipping'));
                        document.getElementById('offer2') && (document.getElementById('offer2').checked = productToEdit.offers.includes('Buy 1 Get 1'));
                        document.getElementById('offer3') && (document.getElementById('offer3').checked = productToEdit.offers.includes('10% Cashback'));
                    }
                    
                    // Change modal title and button
                    const modalLabel = document.getElementById('addProductModalLabel');
                    const addBtn = document.getElementById('addProductBtn');
                    if (modalLabel) modalLabel.textContent = 'Edit Product';
                    if (addBtn) {
                        addBtn.textContent = 'Update Product';
                        addBtn.dataset.editingId = productId;
                    }
                    
                    // Show the modal using Bootstrap
                    if (typeof bootstrap !== 'undefined') {
                        const editModal = new bootstrap.Modal(modal);
                        editModal.show();
                    } else {
                        // Fallback if Bootstrap is not available
                        modal.style.display = 'block';
                    }
                }
            });
        });

        // Individual checkbox listeners
        document.querySelectorAll('.row-checkbox').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const allCheckboxes = document.querySelectorAll('.row-checkbox');
                const checkedCheckboxes = document.querySelectorAll('.row-checkbox:checked');
                const selectAllCheckbox = document.querySelector('th input[type="checkbox"]');
                
                if (selectAllCheckbox) {
                    selectAllCheckbox.checked = allCheckboxes.length === checkedCheckboxes.length;
                }
            });
        });
    }

    // Toggle select all checkboxes
    function toggleSelectAll(selectAllCheckbox) {
        const checkboxes = document.querySelectorAll('.row-checkbox');
        checkboxes.forEach(checkbox => {
            checkbox.checked = selectAllCheckbox.checked;
        });
    }

    // Make toggleSelectAll globally accessible
    window.toggleSelectAll = toggleSelectAll;

    // Get selected offers from form
    function getSelectedOffers() {
        const option1 = document.getElementById('option1');
        if (option1 && option1.checked) {
            const selected = [];
            if (document.getElementById('offer1')?.checked) selected.push('Free Shipping');
            if (document.getElementById('offer2')?.checked) selected.push('Buy 1 Get 1');
            if (document.getElementById('offer3')?.checked) selected.push('10% Cashback');
            return selected.join(', ');
        } else {
            const offerValue = document.getElementById('offerValue');
            return offerValue ? 'Discount: ' + offerValue.value + '%' : '';
        }
    }

    // Add product button
    const addProductBtn = document.getElementById('addProductBtn');
    if (addProductBtn) {
        addProductBtn.addEventListener('click', function() {
            const isEditing = this.dataset.editingId;
            const products = loadProducts();
            
            // Get form values
            const productIdField = document.getElementById('orderId');
            const productNameField = document.getElementById('productName');
            const stockField = document.getElementById('stock');
            const priceField = document.getElementById('price');
            const discountField = document.getElementById('discount');
            const gstField = document.getElementById('gst');
            const couponCodeField = document.getElementById('couponCode');
            const totalPriceField = document.getElementById('totalPrice');
            const quantityField = document.getElementById('quantity');

            if (!productIdField || !productNameField) {
                alert('Required form fields not found');
                return;
            }

            const productId = productIdField.value;
            const productName = productNameField.value;
            
            if (!productId || !productName) {
                alert('Product ID and Product Name are required');
                return;
            }

            const shopBySelect = document.getElementById('shopBy');
            const shopByOptions = shopBySelect ? 
                Array.from(shopBySelect.selectedOptions).map(option => option.value).join(', ') : '';
            
            // Get selected categories
            const categories = [];
            if (document.getElementById('rings')?.checked) categories.push('Rings');
            if (document.getElementById('necklaces')?.checked) categories.push('Necklaces');
            if (document.getElementById('earrings')?.checked) categories.push('Earrings');
            if (document.getElementById('bracelets')?.checked) categories.push('Bracelets');

            const productData = {
                productId,
                productName,
                categories: categories.join(', ') || 'Uncategorized',
                stock: stockField ? stockField.value : 'In Stock',
                imageSrc: 'https://via.placeholder.com/50',
                shopByOptions,
                price: priceField ? priceField.value : '0.00',
                discount: discountField ? discountField.value : '0',
                gst: gstField ? gstField.value : '0',
                couponCode: couponCodeField ? couponCodeField.value : '',
                totalPrice: totalPriceField ? totalPriceField.value : '0.00',
                quantity: quantityField ? quantityField.value : '1',
                offers: getSelectedOffers()
            };

            // Handle image if uploaded
            const imageFile = document.getElementById('productImage')?.files[0];
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    productData.imageSrc = e.target.result;
                    saveProduct();
                }
                reader.readAsDataURL(imageFile);
            } else {
                saveProduct();
            }

           function saveProduct() {
    // Add this productData object right here, replacing any existing product data object
    const productData = {
        productId,
        productName,
        categories: categories.join(', ') || 'Uncategorized',
        stock: stockField ? stockField.value : 'In Stock',
        imageSrc: 'https://via.placeholder.com/50',
        shopByOptions,
        price: priceField ? priceField.value : '0.00',
        discount: discountField ? discountField.value : '0',
        gst: gstField ? gstField.value : '0',
        couponCode: couponCodeField ? couponCodeField.value : '',
        totalPrice: totalPriceField ? totalPriceField.value : '0.00',
        quantity: quantityField ? quantityField.value : '1',
        sizes: selectedSizes.join(', ') || 'One Size',
        offers: getSelectedOffers()
    };

    if (isEditing) {
        // Update existing product
        const index = products.findIndex(p => p.productId === isEditing);
        if (index !== -1) {
            products[index] = productData;
        }
    } else {
        // Check if product ID already exists
        if (products.find(p => p.productId === productId)) {
            alert('Product ID already exists. Please use a different ID.');
            return;
        }
        // Add new product
        products.push(productData);
    }
    
    saveProducts(products);
    renderProducts();
    
    // Close modal and reset
    const modal = document.getElementById('addProductModal');
    if (modal) {
        if (typeof bootstrap !== 'undefined') {
            const modalInstance = bootstrap.Modal.getInstance(modal);
            if (modalInstance) modalInstance.hide();
        } else {
            modal.style.display = 'none';
        }
    }
    
    const form = document.getElementById('productForm');
    if (form) form.reset();
    if (totalPriceField) totalPriceField.value = '';
    
    const modalLabel = document.getElementById('addProductModalLabel');
    if (modalLabel) modalLabel.textContent = 'Add New Product';
    this.textContent = 'Add Product';
    delete this.dataset.editingId;
}
        });
    }

    // Delete selected products
    const deleteSelectedBtn = document.getElementById('deleteSelectedBtn');
    if (deleteSelectedBtn) {
        deleteSelectedBtn.addEventListener('click', function() {
            const selectedCheckboxes = document.querySelectorAll('.row-checkbox:checked');
            if (selectedCheckboxes.length === 0) {
                alert('Please select at least one product to delete');
                return;
            }

            if (confirm(`Are you sure you want to delete ${selectedCheckboxes.length} selected product(s)?`)) {
                const productIds = Array.from(selectedCheckboxes).map(checkbox => {
                    return checkbox.closest('tr').cells[1].textContent;
                });

                const products = loadProducts();
                const updatedProducts = products.filter(p => !productIds.includes(p.productId));
                saveProducts(updatedProducts);
                renderProducts();
                
                // Uncheck select all checkbox if it was checked
                const selectAllCheckbox = document.querySelector('th input[type="checkbox"]');
                if (selectAllCheckbox) {
                    selectAllCheckbox.checked = false;
                }
            }
        });
    }

    // Store current filter values
    let currentFilters = {
        category: 'all',
        price: 'all'
    };

    // Filter products based on search, category, and price
    function filterProducts() {
        const searchInput = document.getElementById('searchInput');
        const searchText = searchInput ? searchInput.value.toLowerCase().trim() : '';
        const selectedCategory = currentFilters.category;
        const selectedPrice = currentFilters.price;

        const products = loadProducts();
        
        const filteredProducts = products.filter(product => {
            // Search filter - search in Product ID and Product Name
            const matchesSearch = searchText === '' || 
                product.productId.toLowerCase().includes(searchText) || 
                product.productName.toLowerCase().includes(searchText);
            
            // Category filter
            const matchesCategory = selectedCategory === 'all' || 
                product.categories.toLowerCase().includes(selectedCategory.toLowerCase());
            
            // Price filter
            const price = parseFloat(product.price);
            let matchesPrice = true;
            
            if (selectedPrice === 'under10000') {
                matchesPrice = price < 10000;
            } else if (selectedPrice === '10000-100000') {
                matchesPrice = price >= 10000 && price <= 100000;
            } else if (selectedPrice === 'over100000') {
                matchesPrice = price > 100000;
            }
            
            return matchesSearch && matchesCategory && matchesPrice;
        });
        
        renderProducts(filteredProducts);
    }

    // Reset filters and show all products
    function resetFilters() {
        const searchInput = document.getElementById('searchInput');
        if (searchInput) searchInput.value = '';
        
        // Reset filter values
        currentFilters.category = 'all';
        currentFilters.price = 'all';
        
        // Reset dropdown selections
        document.querySelectorAll('#categoryDropdown + .dropdown-menu .dropdown-item, #priceDropdown + .dropdown-menu .dropdown-item')
            .forEach(item => item.classList.remove('active'));
        document.querySelector('#categoryDropdown + .dropdown-menu .dropdown-item[data-value="all"]')?.classList.add('active');
        document.querySelector('#priceDropdown + .dropdown-menu .dropdown-item[data-value="all"]')?.classList.add('active');
        
        // Update dropdown button text
        const categoryDropdown = document.getElementById('categoryDropdown');
        const priceDropdown = document.getElementById('priceDropdown');
        if (categoryDropdown) categoryDropdown.textContent = 'Category';
        if (priceDropdown) priceDropdown.textContent = 'Price';
        
        // Render all products
        renderProducts();
        
        // Close dropdowns if open
        if (typeof bootstrap !== 'undefined') {
            const categoryDropdownInstance = bootstrap.Dropdown.getInstance(categoryDropdown);
            const priceDropdownInstance = bootstrap.Dropdown.getInstance(priceDropdown);
            if (categoryDropdownInstance) categoryDropdownInstance.hide();
            if (priceDropdownInstance) priceDropdownInstance.hide();
        }
    }

    // Filter button
    const filterBtn = document.getElementById('filterBtn');
    if (filterBtn) {
        filterBtn.addEventListener('click', function(e) {
            e.preventDefault();
            filterProducts();
        });
    }
    
    // Search button
    const searchBtn = document.getElementById('searchBtn');
    if (searchBtn) {
        searchBtn.addEventListener('click', function(e) {
            e.preventDefault();
            filterProducts();
        });
    }
    
    // Also filter when pressing Enter in search input
    const searchInput = document.getElementById('searchInput');
    if (searchInput) {
        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                filterProducts();
            }
        });
    }

    // Reset button
    const resetBtn = document.getElementById('resetBtn');
    if (resetBtn) {
        resetBtn.addEventListener('click', function(e) {
            e.preventDefault();
            resetFilters();
        });
    }

    // Category dropdown items
    document.querySelectorAll('#categoryDropdown + .dropdown-menu .dropdown-item').forEach(item => {
        item.addEventListener('click', function(e) {
            e.preventDefault();
            // Remove active class from all items
            document.querySelectorAll('#categoryDropdown + .dropdown-menu .dropdown-item').forEach(i => i.classList.remove('active'));
            // Add active class to clicked item
            this.classList.add('active');
            
            // Update current filter
            currentFilters.category = this.getAttribute('data-value') || 'all';
            
            const categoryText = this.textContent;
            const categoryDropdown = document.getElementById('categoryDropdown');
            if (categoryDropdown) categoryDropdown.textContent = categoryText;
        });
    });

    // Price dropdown items
    document.querySelectorAll('#priceDropdown + .dropdown-menu .dropdown-item').forEach(item => {
        item.addEventListener('click', function(e) {
            e.preventDefault();
            // Remove active class from all items
            document.querySelectorAll('#priceDropdown + .dropdown-menu .dropdown-item').forEach(i => i.classList.remove('active'));
            // Add active class to clicked item
            this.classList.add('active');
            
            // Update current filter
            currentFilters.price = this.getAttribute('data-value') || 'all';
            
            const priceText = this.textContent;
            const priceDropdown = document.getElementById('priceDropdown');
            if (priceDropdown) priceDropdown.textContent = priceText;
        });
    });

    // Import file handler
    window.handleImport = function() {
        const fileInput = document.getElementById('fileInput');
        if (fileInput && fileInput.files.length > 0) {
            alert(`Importing ${fileInput.files.length} file(s)`);
            // Here you would typically process the file and add products
        } else {
            alert('Please select files first');
        }
    };

    // Offer type toggle
    const option1 = document.getElementById('option1');
    const option2 = document.getElementById('option2');
    
    if (option1) {
        option1.addEventListener('change', function() {
            if (this.checked) {
                const option1Options = document.getElementById('option1Options');
                const option2Input = document.getElementById('option2Input');
                if (option1Options) option1Options.style.display = 'block';
                if (option2Input) option2Input.style.display = 'none';
            }
        });
    }

    if (option2) {
        option2.addEventListener('change', function() {
            if (this.checked) {
                const option1Options = document.getElementById('option1Options');
                const option2Input = document.getElementById('option2Input');
                if (option1Options) option1Options.style.display = 'none';
                if (option2Input) option2Input.style.display = 'block';
            }
        });
    }

    // Export functionality
    function exportToExcel() {
        try {
            const products = loadProducts();
            if (products.length === 0) {
                alert('No data to export');
                return;
            }

            // Create workbook and worksheet
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(products.map(product => ({
                'Product ID': product.productId,
                'Product Name': product.productName,
                'Categories': product.categories,
                'Stock': product.stock,
                'Shop By Options': product.shopByOptions,
                'Price': product.price,
                'Discount': product.discount + '%',
                'GST': product.gst + '%',
                'Coupon Code': product.couponCode,
                'Total Price': product.totalPrice,
                'Quantity': product.quantity,
                'Offers': product.offers
            })));

            XLSX.utils.book_append_sheet(wb, ws, 'Products');
            XLSX.writeFile(wb, 'products_export.xlsx');
        } catch (error) {
            console.error('Export to Excel failed:', error);
            alert('Excel export failed. Please ensure XLSX library is loaded.');
        }
    }

    function exportToCSV() {
        try {
            const products = loadProducts();
            if (products.length === 0) {
                alert('No data to export');
                return;
            }

            // Create CSV content
            const headers = ['Product ID', 'Product Name', 'Categories', 'Stock', 'Shop By Options', 'Price', 'Discount', 'GST', 'Coupon Code', 'Total Price', 'Quantity', 'Offers'];
            const csvContent = [
                headers.join(','),
                ...products.map(product => [
                    `"${product.productId}"`,
                    `"${product.productName}"`,
                    `"${product.categories}"`,
                    `"${product.stock}"`,
                    `"${product.shopByOptions}"`,
                    `"${product.price}"`,
                    `"${product.discount}%"`,
                    `"${product.gst}%"`,
                    `"${product.couponCode}"`,
                    `"${product.totalPrice}"`,
                    `"${product.quantity}"`,
                    `"${product.offers}"`
                ].join(','))
            ].join('\n');

            // Create and download CSV file
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'products_export.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        } catch (error) {
            console.error('Export to CSV failed:', error);
            alert('CSV export failed.');
        }
    }

    // Add event listeners to export dropdown items
    document.addEventListener('click', function(e) {
        if (e.target.textContent.includes('Excel') || e.target.closest('.dropdown-item')?.textContent.includes('Excel')) {
            e.preventDefault();
            exportToExcel();
        } else if (e.target.textContent.includes('CSV') || e.target.closest('.dropdown-item')?.textContent.includes('CSV')) {
            e.preventDefault();
            exportToCSV();
        }
    });

    // Make export functions globally accessible
    window.exportToExcel = exportToExcel;
    window.exportToCSV = exportToCSV;
});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

</body>
</html>