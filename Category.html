<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Categories</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    
    <style>
        /* Add this to your existing CSS */
.product-table-container table td:last-child {
    white-space: nowrap; /* Prevent buttons from wrapping */
}

.product-table-container table td:last-child .btn {
    display: inline-block; /* Ensure buttons stay inline */
    margin-right: 5px; /* Add some spacing between buttons */
}

.product-table-container table td:last-child .btn:last-child {
    margin-right: 0; /* Remove margin from last button */
}



        body {
            margin: 0;
            padding: 0;
            width: 100%;
            font-family: Arial, sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        .navbar {
            background-color: #2d2d30;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            font-family: "roboto";
        }
        
        .navbar .dashboard {
            color: white;
            font-size: 18px;
            display: flex;
            align-items: center;
        }
        
        .navbar .menu-icon {
            color: white;
            margin-left: 15px;
            cursor: pointer;
        }
        
        .navbar .icons {
            display: flex;
            align-items: center;
        }
        
        .icons>i {
            margin-right: 20px;
        }
        
        .profile-dropdown {
            position: relative;
            display: inline-block;
        }
        
        .profile-menu {
            display: none;
            position: absolute;
            right: 0;
            background: white;
            box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            width: 150px;
            z-index: 1000;
        }
        
        .profile-menu a {
            display: block;
            padding: 10px;
            text-decoration: none;
            color: black;
        }
        
        .profile-menu a:hover {
            background: #f1f1f1;
        }
        
        .profile-icon {
            cursor: pointer;
            color: white;
            font-size: 1.2em;
        }
        
        .left-nav {
            width: 220px;
            background-color: #2d2d30;
            position: fixed;
            top: 50px;
            left: 0;
            height: calc(100vh - 50px);
            display: none;
            padding: 10px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            z-index: 999;
            font-family: "Open Sans";
        }
        
        .left-nav .category {
            cursor: pointer;
            margin: 15px 0;
            color: rgb(255, 255, 255);
        }


        .left-nav .sub-category a div,
        .left-nav .category {
        color: rgb(255, 255, 255) !important;
        text-decoration: none !important;
        }

        .left-nav .sub-category a:hover div {
            color: black !important;
            text-decoration: none !important;
        }

        .left-nav .sub-category a {
            text-decoration: none !important;
        }
        
        .sub-category {
            margin-left: 20px;
            display: none;
        }
        
        .logout-button {
            background-color: #005f73;
            color: #d3d3d3;
            border: none;
            padding: 10px;
            width: 100%;
            cursor: pointer;
            margin-top: 20px;
        }
        
        .logout-button:hover {
            background-color: #007bff;
        }
        
        .main-content {
            margin-left: 18%;
            padding: 70px 0px 0px 0px;
            transition: margin-left 0.3s;
            font-family: "Ancizar Serif ";
        }
        
     
        
        footer {
            background-color: #808080;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 30px;
            width: 100%;
            /* font-family: "Open Sans"; */
            font-family: "Ancizar Serif ";
        }
        

        .left-nav a {
        color: inherit !important;
        text-decoration: none !important;
        }

        .left-nav a:hover {
        color: inherit !important;
        text-decoration: none !important;
        }

        .profile-icon {
        cursor: pointer;
        color: white;
        font-size: 1.7em; 
        }

        .main-content{
                        font-family: "Ancizar Serif ";
        }

    </style>
</head>

<body>
    <nav class="navbar">
        <div class="dashboard">
            <i class="fas fa-bars menu-icon" id="menuIcon"></i>
            <span style="margin-left: 10px; font-size: 20px;">Dashboard</span>
        </div>

        <!-- <a href="Dashboard.html" style="text-decoration: none; color: inherit;">
    <div class="dashboard">
        <i class="fas fa-bars menu-icon" id="menuIcon"></i>
        <span style="margin-left: 10px; font-size: 20px;">Dashboard</span>
    </div>
</a> -->

        <div class="icons">
            <div class="profile-dropdown">
                <i class="fas fa-user-circle profile-icon" id="profileIcon"></i>
                <div class="profile-menu" id="profileMenu" style=" font-family: Open Sans;">
                    <a href="">Profile</a>
                    <a href="Login.html">Logout</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="left-nav" id="leftNav">
        <div class="category" id="catalog">Inventory<i class="fas fa-chevron-down" id="catalogToggle"></i></div>
        <div class="sub-category" id="catalogSub">
           <a href="Products.html"><div>Products</div></a> 
            <a href="Category.html"><div>Categories</div></a>
            <a href="Coupon.html"><div>Coupons</div></a>
        </div>
        <div class="category" id="customers">Customers <i class="fas fa-chevron-down" id="customersToggle"></i></div>
        <div class="sub-category" id="customersSub">
           <a href="CustomerDetails.html"><div>Customer Details</div></a> 
        </div>
       <a href=""><div class="category" >Orders</div></a> 
        <div class="category" id="onlineStore">Online Store <i class="fas fa-chevron-down" id="onlineStoreToggle"></i></div>
        <div class="sub-category" id="onlineStoreSub" style="display: none;">
            <a href=""><div>View Store</div></a>
            <a href="StoreCustomization.html"><div>Store Customization</div></a>
            <a href="StoreSettings.html"><div>Store Settings</div></a>
        </div>
        <a href="OurStaff.html"><div class="category">Our Staff</div></a>
       <a href="Settings.html"><div class="category" id="settings">Settings</div></a> 
        <button class="logout-button" onclick="window.location.href='login.html'"> <i class="fas fa-sign-out-alt"></i> Logout</button>
    </div>

    <div class="main-content">
        <h3 class="mb-4" style="font-size:21px; font-weight: 350; font-family:roboto; "><b>Categories</b></h3>
    </div>

    <div class="button-container d-flex justify-content-between align-items-center" style="margin-left: 270px; margin-top: 20px; margin-bottom: 30px; padding: 25px; background-color: #f8f9fa; border-radius: 5px; margin-right: 40px;border:1px solid grey">
        <div class="left-buttons">
            <div class="btn-group me-2">
                <button class="btn btn-outline-primary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fas fa-file-export"></i> Export
                </button>
                <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="#"><i class="fas fa-file-excel"></i> Export by Excel</a></li>
                    <li><a class="dropdown-item" href="#"><i class="fas fa-file-csv"></i> Export by CSV</a></li>
                </ul>
            </div>
            <div class="btn-group">
                <button class="btn btn-outline-success" type="button" data-bs-toggle="collapse" data-bs-target="#importCollapse">
                    <i class="fas fa-file-import"></i> Import
                </button>
                <div id="importCollapse" class="collapse" style="position: absolute; z-index: 1000; width: 300px; margin-top: 5px;">
                    <div class="card card-body" style="border: 2px dashed #6c757d; padding: 20px;">
                        <input type="file" id="fileInput" style="display: none;" multiple>
                        <p class="text-center" onclick="document.getElementById('fileInput').click()" style="cursor: pointer;">Click to select files</p>
                        <button class="btn btn-primary ms-auto" style="width: fit-content;" onclick="handleImport()">
                            <i class="fas fa-upload"></i> Import Now
                        </button>
                    </div>
                </div>
                <script>
                    
                </script>
            </div>
        </div>
        <div class="right-buttons">
            <button class="btn btn-outline-danger me-2" id="deleteSelectedBtn">
                <i class="fas fa-trash"></i> Delete
            </button>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addProductModal">
                <i class="fas fa-plus"></i> Add Category
            </button>
        </div>
    </div>

    <div class="filter-container d-flex align-items-center" style="margin-left: 270px; margin-top: 20px; margin-bottom: 30px; padding: 25px; background-color: #f8f9fa; border-radius: 5px; margin-right: 40px; border:1px solid grey">
        <div class="search-box me-3" style="flex: 1;">
            <div class="input-group">
                <input type="text" class="form-control" placeholder="Search products...">
                <button class="btn btn-outline-secondary" type="button">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>

        <div class="dropdown me-3">
            <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="categoryDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                Category
            </button>
            <ul class="dropdown-menu" aria-labelledby="categoryDropdown">
                <li><a class="dropdown-item" href="#">All Categories</a></li>
                <li><a class="dropdown-item" href="#">Necklaces</a></li>
                <li><a class="dropdown-item" href="#">Rings</a></li>
                <li><a class="dropdown-item" href="#">Bracelets</a></li>
                <li><a class="dropdown-item" href="#">Earrings</a></li>

            </ul>
        </div>

        <div class="dropdown me-3">
            <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="priceDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                Price
            </button>
            <ul class="dropdown-menu" aria-labelledby="priceDropdown">
                <li><a class="dropdown-item" href="#">All Prices</a></li>
                <li><a class="dropdown-item" href="#">Under ₹10000</a></li>
                <li><a class="dropdown-item" href="#">₹10000 - ₹100000</a></li>
                <li><a class="dropdown-item" href="#">Over ₹100000</a></li>
            </ul>
        </div>

        <button class="btn btn-primary me-2" id="filterBtn">
            <i class="fas fa-filter"></i> Filter
        </button>

        <button class="btn btn-outline-danger" id="resetBtn">
            <i class="fas fa-undo"></i> Reset
        </button>
    </div>

    <div class="product-table-container" style="margin-left: 270px; margin-right: 40px;">
        <table class="table table-bordered table-hover">
            <thead class="table-light">
                <tr>
                    <th width="50px"><input type="checkbox" onclick="toggleSelectAll(this)"></th>
                    <th>Order ID</th>
                    <th>Product Name</th>
                    <th>Category</th>
                    <th>Stock</th>
                    <th>Product Image</th>
                    <th>Shop By</th>
                    <th>Price</th>
                    <th>Discount</th>
                    <th>GST</th>
                    <th>Coupon Code</th>
                    <th>Total Price</th>
                    <th>Quantity</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>


            </tbody>
        </table>
    </div>

    <div class="left-nav" id="leftNav">
        <div class="category" id="catalog">Catalog <i class="fas fa-chevron-down" id="catalogToggle"></i></div>
        <div class="sub-category" id="catalogSub">
            <div>Products</div>
            <div>Categories</div>
            <div>Attributes</div>
            <div>Coupons</div>
        </div>
        <div class="category" id="customers">Customers <i class="fas fa-chevron-down" id="customersToggle"></i></div>
        <div class="sub-category" id="customersSub">
            <div>Customer Details</div>
        </div>
        <div class="category">Orders</div>
        <div class="category" id="onlineStore">Online Store <i class="fas fa-chevron-down" id="onlineStoreToggle"></i></div>
        <div class="sub-category" id="onlineStoreSub" style="display: none;">
            <div>View Store</div>
            <div>Store Customization</div>
            <!-- <div>Store Settings</div> -->
        </div>
        <div class="category">Our Staff</div>
        <div class="category" id="settings">Settings</div>
        <button class="logout-button"> <i class="fas fa-sign-out-alt"></i> Logout</button>
    </div>

    <!-- Add Product Modal -->
<div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addProductModalLabel">Add New Product</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addProductForm">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="orderId" class="form-label">Order ID *</label>
                            <input type="text" class="form-control" id="orderId" required>
                        </div>
                        <div class="col-md-6">
                            <label for="productName" class="form-label">Product Name *</label>
                            <input type="text" class="form-control" id="productName" required>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Category *</label>
                            <div class="border p-2" style="max-height: 150px; overflow-y: auto;">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="categoryNecklaces" value="Necklaces">
                                    <label class="form-check-label" for="categoryNecklaces">Necklaces</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="categoryRings" value="Rings">
                                    <label class="form-check-label" for="categoryRings">Rings</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="categoryBracelets" value="Bracelets">
                                    <label class="form-check-label" for="categoryBracelets">Bracelets</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="categoryEarrings" value="Earrings">
                                    <label class="form-check-label" for="categoryEarrings">Earrings</label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="stockStatus" class="form-label">Stock Status *</label>
                            <select class="form-select" id="stockStatus" required>
                                <option value="In Stock">In Stock</option>
                                <option value="Out of Stock">Out of Stock</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Shop By</label>
                            <div class="border p-2" style="max-height: 150px; overflow-y: auto;">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="shopWedding" value="Wedding Wear">
                                    <label class="form-check-label" for="shopWedding">Wedding Wear</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="shopCasual" value="Casual Wear">
                                    <label class="form-check-label" for="shopCasual">Casual Wear</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="shopParty" value="Party Wear">
                                    <label class="form-check-label" for="shopParty">Party Wear</label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="productImage" class="form-label">Product Image</label>
                            <input type="file" class="form-control" id="productImage" accept="image/*">
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <label for="price" class="form-label">Price (₹) *</label>
                            <input type="number" class="form-control" id="price" min="0" step="0.01" required>
                        </div>
                        <div class="col-md-3">
                            <label for="discount" class="form-label">Discount (%)</label>
                            <input type="number" class="form-control" id="discount" min="0" max="100" value="0">
                        </div>
                        <div class="col-md-3">
                            <label for="gst" class="form-label">GST (%)</label>
                            <input type="number" class="form-control" id="gst" min="0" value="18">
                        </div>
                        <div class="col-md-3">
                            <label for="couponCode" class="form-label">Coupon Code</label>
                            <input type="text" class="form-control" id="couponCode">
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="quantity" class="form-label">Quantity *</label>
                            <div class="input-group">
                                <button class="btn btn-outline-secondary" type="button" id="decrementQty">-</button>
                                <input type="number" class="form-control text-center" id="quantity" value="1" min="1" required>
                                <button class="btn btn-outline-secondary" type="button" id="incrementQty">+</button>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="totalPrice" class="form-label">Total Price (₹)</label>
                            <input type="text" class="form-control" id="totalPrice" readonly>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveProductBtn">
                    <i class="fas fa-save"></i> Add Product
                </button>
            </div>
        </div>
    </div>
</div>


    <footer style="background-color: #f0f0f0; height: 60px; display: flex; align-items: center; justify-content: center;font-family: Open Sans;">
        <!-- <img src="Img/logo.jpg" alt="Kunash Media Logo" style="height: 40px;  width:60px ;margin-right: 15px;"> -->
        <p style="color: black; font-weight: 400; margin: 0; font-size: medium;">© 2025 Kunash Media | Developed by Pranjal Prasad</p>
    </footer>



<script>
document.addEventListener('DOMContentLoaded', function() {
    // Navigation toggle functionality
    const menuIcon = document.getElementById('menuIcon');
    const leftNav = document.getElementById('leftNav');
    
    menuIcon.addEventListener('click', function(e) {
        e.stopPropagation();
        leftNav.style.display = leftNav.style.display === 'block' ? 'none' : 'block';
    });

    // Profile dropdown functionality
    const profileIcon = document.getElementById('profileIcon');
    const profileMenu = document.getElementById('profileMenu');
    
    profileIcon.addEventListener('click', function(e) {
        e.stopPropagation();
        profileMenu.style.display = profileMenu.style.display === 'block' ? 'none' : 'block';
    });

    // Close profile menu when clicking outside
    document.addEventListener('click', function() {
        profileMenu.style.display = 'none';
    });

    // Submenu toggle functionality
    function setupSubmenuToggle(toggleId, submenuId) {
        const toggle = document.getElementById(toggleId);
        const submenu = document.getElementById(submenuId);
        
        if (toggle && submenu) {
            toggle.addEventListener('click', function(e) {
                e.stopPropagation();
                submenu.style.display = submenu.style.display === 'block' ? 'none' : 'block';
                
                // Rotate chevron icon
                const icon = this.querySelector('i');
                if (icon) {
                    icon.classList.toggle('fa-chevron-down');
                    icon.classList.toggle('fa-chevron-up');
                }
            });
        }
    }

    // Set up all submenu toggles
    setupSubmenuToggle('onlineStoreToggle', 'onlineStoreSub');
    setupSubmenuToggle('catalogToggle', 'catalogSub');
    setupSubmenuToggle('customersToggle', 'customersSub');

    // Make left nav clickable
    leftNav.addEventListener('click', function(e) {
        e.stopPropagation();
    });

    // Close left nav when clicking outside
    document.addEventListener('click', function() {
        leftNav.style.display = 'none';
    });

    // Initialize products from localStorage if available
    let products = JSON.parse(localStorage.getItem('products')) || [];
    
    // Render existing products on page load
    renderProducts();

    // Add Product modal functionality
    const addProductModal = document.getElementById('addProductModal');
    if (addProductModal) {
        const modal = new bootstrap.Modal(addProductModal);
        
        // Quantity increment/decrement
        document.getElementById('incrementQty').addEventListener('click', function() {
            const quantityInput = document.getElementById('quantity');
            quantityInput.value = parseInt(quantityInput.value) + 1;
            calculateTotalPrice();
        });
        
        document.getElementById('decrementQty').addEventListener('click', function() {
            const quantityInput = document.getElementById('quantity');
            if (parseInt(quantityInput.value) > 1) {
                quantityInput.value = parseInt(quantityInput.value) - 1;
                calculateTotalPrice();
            }
        });
        
        // Auto-calculate total price when inputs change
        document.getElementById('price').addEventListener('input', calculateTotalPrice);
        document.getElementById('discount').addEventListener('input', calculateTotalPrice);
        document.getElementById('gst').addEventListener('input', calculateTotalPrice);
        document.getElementById('couponCode').addEventListener('input', calculateTotalPrice);
        document.getElementById('quantity').addEventListener('input', calculateTotalPrice);
        
        function calculateTotalPrice() {
            const price = parseFloat(document.getElementById('price').value) || 0;
            const discount = parseFloat(document.getElementById('discount').value) || 0;
            const gst = parseFloat(document.getElementById('gst').value) || 0;
            const quantity = parseInt(document.getElementById('quantity').value) || 1;
            
            // Simple calculation (you can modify this as needed)
            const discountedPrice = price - (price * discount / 100);
            const priceWithGst = discountedPrice + (discountedPrice * gst / 100);
            const total = priceWithGst * quantity;
            
            document.getElementById('totalPrice').value = total.toFixed(2);
        }
        
        // Handle form submission
        const saveProductBtn = document.getElementById('saveProductBtn');
        if (saveProductBtn) {
            saveProductBtn.addEventListener('click', function() {
                const form = document.getElementById('addProductForm');
                const orderId = document.getElementById('orderId').value;
                const productName = document.getElementById('productName').value;
                
                // Validate required fields
                if (!orderId.trim() || !productName.trim()) {
                    alert('Please fill all required fields');
                    return;
                }
                
                // Get selected categories
                const selectedCategories = [];
                document.querySelectorAll('[id^="category"]:checked').forEach(checkbox => {
                    selectedCategories.push(checkbox.value);
                });
                
                // Get selected shop by options
                const selectedShopBy = [];
                document.querySelectorAll('[id^="shop"]:checked').forEach(checkbox => {
                    selectedShopBy.push(checkbox.value);
                });
                
                // Create product object with unique ID
                const newProduct = {
                    id: Date.now(), // Unique ID for each product
                    orderId: orderId,
                    productName: productName,
                    categories: selectedCategories.join(', '),
                    stock: document.getElementById('stockStatus').value,
                    shopBy: selectedShopBy.join(', '),
                    price: document.getElementById('price').value,
                    discount: document.getElementById('discount').value,
                    gst: document.getElementById('gst').value,
                    couponCode: document.getElementById('couponCode').value,
                    quantity: document.getElementById('quantity').value,
                    totalPrice: document.getElementById('totalPrice').value,
                    // Note: File handling would need additional implementation
                    image: document.getElementById('productImage').files[0] ? 
                          document.getElementById('productImage').files[0].name : 'No image'
                };
                
                // Add to products array
                products.push(newProduct);
                
                // Save to localStorage
                localStorage.setItem('products', JSON.stringify(products));
                
                // Add to table
                addProductToTable(newProduct);
                
                // Reset form and close modal
                form.reset();
                modal.hide();
            });
        }
        
        // Reset form when modal is closed
        addProductModal.addEventListener('hidden.bs.modal', function() {
            document.getElementById('addProductForm').reset();
            document.getElementById('totalPrice').value = '';
        });
    }
    
    function addProductToTable(product) {
        const tbody = document.querySelector('.product-table-container tbody');
        const newRow = document.createElement('tr');
        newRow.setAttribute('data-id', product.id);
        
        newRow.innerHTML = `
            <td><input type="checkbox" class="row-checkbox"></td>
            <td>${product.orderId}</td>
            <td>${product.productName}</td>
            <td>${product.categories}</td>
            <td>${product.stock}</td>
            <td>${product.image}</td>
            <td>${product.shopBy}</td>
            <td>₹${product.price}</td>
            <td>${product.discount}%</td>
            <td>${product.gst}%</td>
            <td>${product.couponCode || '-'}</td>
            <td>₹${product.totalPrice}</td>
            <td>${product.quantity}</td>
            <td>
                <button class="btn btn-sm btn-outline-primary me-1 edit-btn"><i class="fas fa-edit"></i></button>
                <button class="btn btn-sm btn-outline-danger delete-btn"><i class="fas fa-trash"></i></button>
            </td>
        `;
        
        tbody.appendChild(newRow);
        
        // Add event listener to the delete button
        newRow.querySelector('.delete-btn').addEventListener('click', function() {
            deleteProduct(product.id);
        });
    }
    
    function deleteProduct(productId) {
        if (confirm('Are you sure you want to delete this product?')) {
            // Remove from products array
            products = products.filter(product => product.id !== productId);
            
            // Update localStorage
            localStorage.setItem('products', JSON.stringify(products));
            
            // Remove from table
            document.querySelector(`tr[data-id="${productId}"]`).remove();
            
            alert('Product deleted successfully');
        }
    }
    // Add this inside your DOMContentLoaded event listener, after the deleteProduct function
// Edit button functionality
document.addEventListener('click', function(e) {
    if (e.target.closest('.edit-btn')) {
        const row = e.target.closest('tr');
        const productId = parseInt(row.getAttribute('data-id'));
        editProduct(productId);
    }
});

function editProduct(productId) {
    // Find the product in the array
    const product = products.find(p => p.id === productId);
    if (!product) return;

    // Get the modal instance
    const addProductModal = document.getElementById('addProductModal');
    const modal = bootstrap.Modal.getInstance(addProductModal) || new bootstrap.Modal(addProductModal);

    // Fill the form with product data
    document.getElementById('orderId').value = product.orderId;
    document.getElementById('productName').value = product.productName;
    
    // Set categories checkboxes
    document.querySelectorAll('[id^="category"]').forEach(checkbox => {
        checkbox.checked = product.categories.includes(checkbox.value);
    });
    
    document.getElementById('stockStatus').value = product.stock;
    
    // Set shop by checkboxes
    document.querySelectorAll('[id^="shop"]').forEach(checkbox => {
        checkbox.checked = product.shopBy.includes(checkbox.value);
    });
    
    document.getElementById('price').value = product.price;
    document.getElementById('discount').value = product.discount;
    document.getElementById('gst').value = product.gst;
    document.getElementById('couponCode').value = product.couponCode || '';
    document.getElementById('quantity').value = product.quantity;
    document.getElementById('totalPrice').value = product.totalPrice;
    
    // Change the save button to update mode
    const saveProductBtn = document.getElementById('saveProductBtn');
    saveProductBtn.textContent = 'Update Product';
    saveProductBtn.dataset.editingId = productId;
    
    // Show the modal
    modal.show();
}

// Modify your existing saveProductBtn event listener to handle both add and edit
// Replace the existing saveProductBtn event listener with this:
if (saveProductBtn) {
    saveProductBtn.addEventListener('click', function() {
        const form = document.getElementById('addProductForm');
        const orderId = document.getElementById('orderId').value;
        const productName = document.getElementById('productName').value;
        
        // Validate required fields
        if (!orderId.trim() || !productName.trim()) {
            alert('Please fill all required fields');
            return;
        }
        
        // Get selected categories
        const selectedCategories = [];
        document.querySelectorAll('[id^="category"]:checked').forEach(checkbox => {
            selectedCategories.push(checkbox.value);
        });
        
        // Get selected shop by options
        const selectedShopBy = [];
        document.querySelectorAll('[id^="shop"]:checked').forEach(checkbox => {
            selectedShopBy.push(checkbox.value);
        });
        
        // Check if we're editing an existing product
        const isEditing = this.dataset.editingId;
        
        if (isEditing) {
            // Update existing product
            const productIndex = products.findIndex(p => p.id === parseInt(isEditing));
            if (productIndex !== -1) {
                products[productIndex] = {
                    id: parseInt(isEditing),
                    orderId: orderId,
                    productName: productName,
                    categories: selectedCategories.join(', '),
                    stock: document.getElementById('stockStatus').value,
                    shopBy: selectedShopBy.join(', '),
                    price: document.getElementById('price').value,
                    discount: document.getElementById('discount').value,
                    gst: document.getElementById('gst').value,
                    couponCode: document.getElementById('couponCode').value,
                    quantity: document.getElementById('quantity').value,
                    totalPrice: document.getElementById('totalPrice').value,
                    image: document.getElementById('productImage').files[0] ? 
                          document.getElementById('productImage').files[0].name : products[productIndex].image
                };
                
                // Save to localStorage
                localStorage.setItem('products', JSON.stringify(products));
                
                // Update the table row
                updateProductInTable(products[productIndex]);
                
                // Reset the save button
                this.textContent = 'Save Product';
                delete this.dataset.editingId;
            }
        } else {
            // Create new product object with unique ID
            const newProduct = {
                id: Date.now(), // Unique ID for each product
                orderId: orderId,
                productName: productName,
                categories: selectedCategories.join(', '),
                stock: document.getElementById('stockStatus').value,
                shopBy: selectedShopBy.join(', '),
                price: document.getElementById('price').value,
                discount: document.getElementById('discount').value,
                gst: document.getElementById('gst').value,
                couponCode: document.getElementById('couponCode').value,
                quantity: document.getElementById('quantity').value,
                totalPrice: document.getElementById('totalPrice').value,
                image: document.getElementById('productImage').files[0] ? 
                      document.getElementById('productImage').files[0].name : 'No image'
            };
            
            // Add to products array
            products.push(newProduct);
            
            // Save to localStorage
            localStorage.setItem('products', JSON.stringify(products));
            
            // Add to table
            addProductToTable(newProduct);
        }
        
        // Reset form and close modal
        form.reset();
        document.getElementById('totalPrice').value = '';
        modal.hide();
    });
}

function updateProductInTable(product) {
    const row = document.querySelector(`tr[data-id="${product.id}"]`);
    if (row) {
        row.innerHTML = `
            <td><input type="checkbox" class="row-checkbox"></td>
            <td>${product.orderId}</td>
            <td>${product.productName}</td>
            <td>${product.categories}</td>
            <td>${product.stock}</td>
            <td>${product.image}</td>
            <td>${product.shopBy}</td>
            <td>₹${product.price}</td>
            <td>${product.discount}%</td>
            <td>${product.gst}%</td>
            <td>${product.couponCode || '-'}</td>
            <td>₹${product.totalPrice}</td>
            <td>${product.quantity}</td>
            <td>
                <button class="btn btn-sm btn-outline-primary me-1 edit-btn"><i class="fas fa-edit"></i></button>
                <button class="btn btn-sm btn-outline-danger delete-btn"><i class="fas fa-trash"></i></button>
            </td>
        `;
        
        // Reattach event listeners
        row.querySelector('.delete-btn').addEventListener('click', function() {
            deleteProduct(product.id);
        });
    }
}
    
    function renderProducts() {
        const tbody = document.querySelector('.product-table-container tbody');
        tbody.innerHTML = ''; // Clear existing rows
        
        products.forEach(product => {
            addProductToTable(product);
        });
    }

    // Toggle select all functionality
    function toggleSelectAll(source) {
        const checkboxes = document.querySelectorAll('.row-checkbox');
        checkboxes.forEach(checkbox => {
            checkbox.checked = source.checked;
        });
    }

    // Delete selected button functionality
    const deleteSelectedBtn = document.getElementById('deleteSelectedBtn');
    if (deleteSelectedBtn) {
        deleteSelectedBtn.addEventListener('click', function() {
            const checkedBoxes = document.querySelectorAll('.row-checkbox:checked');
            if (checkedBoxes.length === 0) {
                alert('Please select at least one item to delete');
                return;
            }
            
            if (confirm(`Are you sure you want to delete ${checkedBoxes.length} selected item(s)?`)) {
                const idsToDelete = [];
                
                checkedBoxes.forEach(box => {
                    const row = box.closest('tr');
                    const productId = parseInt(row.getAttribute('data-id'));
                    idsToDelete.push(productId);
                });
                
                // Remove from products array
                products = products.filter(product => !idsToDelete.includes(product.id));
                
                // Update localStorage
                localStorage.setItem('products', JSON.stringify(products));
                
                // Remove from table
                checkedBoxes.forEach(box => {
                    box.closest('tr').remove();
                });
                
                alert(`${checkedBoxes.length} item(s) deleted successfully`);
                
                // Uncheck all boxes after deletion
                document.querySelectorAll('.row-checkbox').forEach(box => {
                    box.checked = false;
                });
            }
        });
    }

    // Filter button functionality
    const filterBtn = document.getElementById('filterBtn');
    if (filterBtn) {
        filterBtn.addEventListener('click', function() {
            alert('Filter applied successfully');
            // Here you would typically filter the table data
        });
    }

    // Reset button functionality
    const resetBtn = document.getElementById('resetBtn');
    if (resetBtn) {
        resetBtn.addEventListener('click', function() {
            // Reset search input
            document.querySelector('.search-box input').value = '';
            
            // Reset dropdown selections
            document.querySelectorAll('.dropdown-menu a').forEach(item => {
                item.classList.remove('active');
            });
            
            // Reset dropdown button text
            document.getElementById('categoryDropdown').textContent = 'Category';
            document.getElementById('priceDropdown').textContent = 'Price';
            
            alert('Filters reset successfully');
            // Here you would typically reset the table data
        });
    }

    // Dropdown item selection functionality
    document.querySelectorAll('.dropdown-menu a').forEach(item => {
        item.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Remove active class from all items in this dropdown
            this.parentNode.querySelectorAll('a').forEach(i => {
                i.classList.remove('active');
            });
            
            // Add active class to clicked item
            this.classList.add('active');
            
            // Update dropdown button text
            const dropdownButton = this.closest('.dropdown').querySelector('.dropdown-toggle');
            dropdownButton.textContent = this.textContent;
        });
    });
});

// Search and filter functionality
function filterProducts() {
    const searchTerm = document.querySelector('.search-box input').value.toLowerCase();
    const categoryFilter = document.getElementById('categoryDropdown').textContent;
    const priceFilter = document.getElementById('priceDropdown').textContent;
    
    // Filter products based on search criteria
    const filteredProducts = products.filter(product => {
        // Search term matches Order ID or Product Name
        const matchesSearch = searchTerm === '' || 
            product.orderId.toLowerCase().includes(searchTerm) || 
            product.productName.toLowerCase().includes(searchTerm);
        
        // Category filter
        const matchesCategory = categoryFilter === 'Category' || 
            product.categories.includes(categoryFilter);
        
        // Price filter
        let matchesPrice = true;
        if (priceFilter !== 'Price') {
            const price = parseFloat(product.price);
            if (priceFilter === 'Under ₹10000') {
                matchesPrice = price < 10000;
            } else if (priceFilter === '₹10000 - ₹100000') {
                matchesPrice = price >= 10000 && price <= 100000;
            } else if (priceFilter === 'Over ₹100000') {
                matchesPrice = price > 100000;
            }
        }
        
        return matchesSearch && matchesCategory && matchesPrice;
    });
    
    // Display filtered products
    displayFilteredProducts(filteredProducts);
}

function displayFilteredProducts(filteredProducts) {
    const tbody = document.querySelector('.product-table-container tbody');
    tbody.innerHTML = ''; // Clear existing rows
    
    if (filteredProducts.length === 0) {
        // Show "no results" message
        const tr = document.createElement('tr');
        tr.innerHTML = `<td colspan="14" class="text-center">No matching products found</td>`;
        tbody.appendChild(tr);
    } else {
        // Add filtered products to table
        filteredProducts.forEach(product => {
            addProductToTable(product);
        });
    }
}

// Store the original products before filtering
let originalProducts = [...products];

// Update the filter button event listener
if (filterBtn) {
    filterBtn.addEventListener('click', function() {
        // Save current state before filtering
        originalProducts = [...products];
        filterProducts();
    });
}

// Update the reset button event listener
if (resetBtn) {
    resetBtn.addEventListener('click', function() {
        // Reset search input
        document.querySelector('.search-box input').value = '';
        
        // Reset dropdown selections
        document.querySelectorAll('.dropdown-menu a').forEach(item => {
            item.classList.remove('active');
        });
        
        // Reset dropdown button text
        document.getElementById('categoryDropdown').textContent = 'Category';
        document.getElementById('priceDropdown').textContent = 'Price';
        
        // Restore original products
        displayFilteredProducts(originalProducts);
    });
}

// Add event listener for search input
document.querySelector('.search-box input').addEventListener('input', function() {
    filterProducts();
});

// Add event listener for dropdown changes
document.querySelectorAll('.dropdown-menu a').forEach(item => {
    item.addEventListener('click', function(e) {
        e.preventDefault();
        
        // Remove active class from all items in this dropdown
        this.parentNode.querySelectorAll('a').forEach(i => {
            i.classList.remove('active');
        });
        
        // Add active class to clicked item
        this.classList.add('active');
        
        // Update dropdown button text
        const dropdownButton = this.closest('.dropdown').querySelector('.dropdown-toggle');
        dropdownButton.textContent = this.textContent;
        
        // Apply filter
        filterProducts();
    });
});


</script>

<!-- Add this right before the closing </body> tag -->
<script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
<script>
    // Export functionality
    document.addEventListener('DOMContentLoaded', function() {
        // Add event listeners to export dropdown items
        document.querySelectorAll('.dropdown-item').forEach(item => {
            if (item.textContent.includes('Excel')) {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    exportToExcel();
                });
            } else if (item.textContent.includes('CSV')) {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    exportToCSV();
                });
            }
        });

        function exportToExcel() {
            // Get table data
            const table = document.querySelector('.product-table-container table');
            const workbook = XLSX.utils.table_to_book(table);
            XLSX.writeFile(workbook, 'products_export.xlsx');
        }

        function exportToCSV() {
            // Get table data
            const table = document.querySelector('.product-table-container table');
            const worksheet = XLSX.utils.table_to_sheet(table);
            const csv = XLSX.utils.sheet_to_csv(worksheet);
            
            // Create download link
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement("a");
            const url = URL.createObjectURL(blob);
            link.setAttribute("href", url);
            link.setAttribute("download", "products_export.csv");
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    });
</script>

</body>
</html>


